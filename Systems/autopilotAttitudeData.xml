<?xml version="1.0"?>

<!--
    Autopilot Configuration for the VC10.
-->





<PropertyList>

	<!--
    =====================
    Primary Attitude Data
    =====================
    -->

	<logic>
		<name>Theta Mach Switch</name>
		<input>
			<and>
				<greater-than>
					<property>fdm/jsbsim/velocities/mach</property>
					<value>0.96</value>
				</greater-than>
				<less-than>>
					<property>fdm/jsbsim/velocities/mach</property>
					<value>1.06</value>
				</less-than>>
			</and>
		</input>
		<output><property>autopilot/internal/thetaMachSw</property></output>
	</logic> 

	<filter>
		<name>pitch_feedback_demand </name>
		<debug>false</debug>
		<type>integrator</type>
		<gain>1.0</gain>
		<!-- integrator tracks pitch angle when thetaMachSw is clear -->
		<input> 
			<condition>
				<not><property>autopilot/internal/thetaMachSw</property></not>
			</condition>
			<expression>
				<product>
					<value>1</value>  <!-- 1 sec time constant -->
					<dif>
						<property>fdm/jsbsim/attitude/theta-deg</property>
						<property>autopilot/internal/thetaD_deg</property>
					</dif>
				</product>
			</expression>
		</input>
		<!-- lock output when thetaMachSw is not set -->
		<input> 
			<value>0.0</value>
		</input>
		<output><property>autopilot/internal/thetaD_deg</property></output>
		<u_min>-20</u_min>
		<u_max>20</u_max>
	</filter>

	<filter>
		<name>Pitch Error</name>
		<debug>false</debug>
		<type>gain</type>
		<gain>1.0</gain>
		<input>
			<expression>
				<dif>
					<property>fdm/jsbsim/attitude/theta-deg</property>
					<property>autopilot/internal/thetaD_deg</property>
				</dif>
			</expression>
		</input>
		<output>autopilot/internal/theta_error</output>
	</filter>

	<filter>
		<name>theta_washout</name>
		<debug>false</debug>
		<type>high-pass</type>
		<filter-time>1.0</filter-time>
		<input><property>fdm/jsbsim/attitude/theta-deg</property></input>
		<output><property>autopilot/internal/theta_washout</property></output>
	</filter>

	<filter>
		<name>theta-thetaD </name>
		<debug>false</debug>
		<type>gain</type>
		<gain>1.0</gain>
		<input> 
			<condition> <!--output is theta_error when thetaMachSw is set -->
				<property>autopilot/internal/thetaMachSw</property>
			</condition>
			<property>autopilot/internal/theta_error</property>
		</input>
		<input> 		<!-- output is theta_washout when thetaMachSw is not set -->
			<property>autopilot/internal/theta_washout</property>
		</input>
		<output><property>autopilot/internal/theta_thetaD</property></output>
		<u_min>-20</u_min>
		<u_max>20</u_max>
	</filter>

</PropertyList>
